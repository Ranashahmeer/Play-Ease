<div class="booking-container">
  <app-searchbar
    [form]="form"
    (toggleFilters)="filtersOpened = !filtersOpened"
    (search)="onSearch(form.get('searchQuery')?.value)"
  ></app-searchbar>

  <!-- Collapsed Filter Summary Box -->
  <div class="filter-summary-box" *ngIf="filtersCollapsed && getActiveFiltersCount() > 0">
    <div class="filter-summary-content">
      <div class="filter-summary-items">
        <span class="filter-badge" *ngFor="let filter of getActiveFiltersSummary()">
          {{ filter }}
        </span>
      </div>
      <div class="filter-summary-actions">
        <button type="button" class="btn-expand" (click)="expandFilters()" title="Expand filters">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="18 15 12 9 6 15"></polyline>
          </svg>
        </button>
        <button type="button" class="btn-close-summary" (click)="closeFilters()" title="Close filters">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>
    </div>
  </div>

  <app-filter-drawer
    [isOpen]="filtersOpened"
    [form]="form"
    [timeOptions]="timeOptionsSidebar"
    [minDate]="minDate"
    (applyFilters)="onApplyFilters()"
    (clearFilters)="onClearFilters()"
    (selectTime)="onTimeSelect($event)"
    (close)="closeFilters()"
    (filterChange)="applyFiltersRealtime()"
  ></app-filter-drawer>

  <!-- Top Half: Court List -->
  <div class="top-section">
    <div class="section-card">
      <div class="section-header">
        <h2>
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
            <line x1="3" y1="9" x2="21" y2="9"></line>
            <line x1="9" y1="21" x2="9" y2="9"></line>
          </svg>
          Available Courts
        </h2>
      </div>
      <div class="section-content">
        <app-court-list
          #courtListRef
          (courtClick)="openCourtDetails($event)"
        ></app-court-list>
      </div>
    </div>
  </div>

  <!-- Bottom Half: Bookings -->
  <div class="bottom-section">
    <app-booking-records></app-booking-records>
  </div>
</div>
